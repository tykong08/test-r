<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GazeHome Edge Device</title>
    <link rel="stylesheet" href="/static/style.css">
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>π  GazeHome Edge Device</h1>
            <div class="status">
                <span id="calibration-status" class="badge">λ³΄μ • ν•„μ”</span>
                <span id="connection-status" class="badge">μ—°κ²° μ¤‘...</span>
            </div>
        </header>

        <!-- Gaze Pointer Overlay (full screen) -->
        <div id="gaze-pointer" class="gaze-pointer"></div>
        <div id="dwell-progress" class="dwell-progress"></div>

        <!-- Control Panel -->
        <div class="control-panel">
            <button id="calibrate-btn" class="btn btn-primary">μ‹μ„  λ³΄μ • μ‹μ‘</button>
            <button id="refresh-btn" class="btn btn-secondary">κΈ°κΈ° μƒλ΅κ³ μΉ¨</button>

            <div class="info">
                <span id="user-uuid">μ‚¬μ©μ: {{ request.scope.get('user_uuid', 'Loading...') }}</span>
                <p class="setting-hint">μ‘μ‹ λλ” κΉλΉ΅μ„μΌλ΅ ν΄λ¦­ κ°€λ¥</p>
            </div>
        </div>

        <!-- Calibration Overlay -->
        <div id="calibration-overlay" class="calibration-overlay hidden">
            <div class="calibration-content">
                <h2>μ‹μ„  λ³΄μ • μ¤‘...</h2>
                <p id="calibration-instruction">λΉ¨κ°„ μ μ„ μ‘μ‹ν•μ„Έμ”</p>

                <!-- Webcam preview during calibration -->
                <div class="calibration-webcam">
                    <img id="calibration-video" src="/video_feed" alt="Webcam Preview">
                    <div class="webcam-hint">
                        <p>β“ μ–Όκµ΄μ΄ ν™”λ©΄ μ¤‘μ•™μ— λ³΄μ΄λ”μ§€ ν™•μΈν•μ„Έμ”</p>
                        <p>β“ μ΅°λ…μ΄ μ¶©λ¶„ν λ°μ€μ§€ ν™•μΈν•μ„Έμ”</p>
                    </div>
                </div>

                <div class="calibration-target" id="calibration-target"></div>
                <div class="calibration-progress">
                    <div id="calibration-progress-bar" class="progress-bar"></div>
                </div>
                <p id="calibration-status-text">
                    ν¬μΈνΈ: <span id="current-point">1</span> / 5 |
                    μƒν”: <span id="sample-count">0</span> / <span id="sample-required">30</span>
                </p>

                <!-- Calibration Settings -->
                <div class="calibration-settings">
                    <label for="dwell-time-slider">μ‘μ‹ λ―Όκ°λ„: <span id="dwell-time-value">0.8</span>μ΄</label>
                    <input type="range" id="dwell-time-slider" min="0.3" max="2.0" step="0.1" value="0.8">
                    <p class="setting-hint">μ§§μ„μλ΅ λΉ λ¥΄κ² λ°μ‘ (κ¶μ¥: 0.8μ΄)</p>
                </div>

                <button id="skip-calibration" class="btn btn-secondary">κ±΄λ„λ›°κΈ°</button>
            </div>
        </div>

        <!-- Device Grid -->
        <div class="device-grid" id="device-grid">
            <!-- Devices will be populated here -->
        </div>

        <!-- Recommendation Popup -->
        <div id="recommendation-popup" class="recommendation-popup hidden">
            <div class="popup-content">
                <h3>π’΅ AI μ¶”μ²</h3>
                <p id="recommendation-text">μ¶”μ² λ©”μ‹μ§€κ°€ μ—¬κΈ°μ— ν‘μ‹λ©λ‹λ‹¤.</p>
                <div class="popup-actions">
                    <button id="rec-yes-btn" class="btn btn-success">YES</button>
                    <button id="rec-no-btn" class="btn btn-danger">NO</button>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>

</html>